<!-- Footer -->
<footer class="wrapper style1 align-center">
    <div class="inner">
        <ul class="icons">
            {{ with .Site.Params.social.github }}<li><a target="_blank" href="{{.}}" class="icon brands style2 fa-github"><span class="label">Github</span></a></li>{{end}}
            {{ with .Site.Params.social.twitter }}<li><a target="_blank" href="{{.}}" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li>{{end}}
            {{ with .Site.Params.social.instagram }}<li><a target="_blank" href="{{.}}" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li>{{end}}
            {{ with .Site.Params.social.linkedin }}<li><a target="_blank" href="{{.}}" class="icon brands style2 fa-linkedin"><span class="label">LinkedIn</span></a></li>{{end}}
            {{ with .Site.Params.social.email }}<li><a target="_blank" href="mailto:{{.}}" class="fav icon style2 fa-envelope"><span class="label">Email</span></a></li>{{end}}
        </ul>
        <p>Hugo Story &copy; 2020 <a target="_blank" href="https://github.com/caressofsteel/">CaressOfSteel</a><span class="footerspacer icon fa-diamond"></span>
            Ported from <a target="_blank" href="https://html5up.net/uploads/demos/story/">Story</a> by HTML5UP<span class="footerspacer icon fa-diamond"></span>
            Images courtesy of <a target="_blank" href="https://unsplash.com">Unsplash</a></p>
</div>
</footer>

<script>
(function () {
  var root    = document.querySelector('#banner .menu-frame');
  if (!root) return;

  var frame   = root.querySelector('iframe');
  var overlay = root.querySelector('.menu-frame__loader');
  if (!frame) return;

  // --- helpers ---
  function setHeight(px) {
    if (!px || !isFinite(px)) return;
    var h = Math.max(40, Math.min(px, 1000));
    frame.style.height = h + 'px';
  }

  function reveal() {
    // 1) start iframe fade-in
    root.classList.add('menu-frame--ready');
    // 2) after the fade begins, hide the spinner overlay a hair later
    if (overlay) {
      setTimeout(function () {
        overlay.style.opacity = '0';
        overlay.style.visibility = 'hidden';
      }, 350); // match CSS transition duration
    }
  }

  // --- messaging from iframe ---
  window.addEventListener('message', function (e) {
    if (e.source !== frame.contentWindow || !e.data) return;

    // dynamic height support (optional but nice)
    if (e.data.type === 'menuSize' && typeof e.data.height === 'number') {
      setHeight(e.data.height);
      return;
    }

    // only reveal when iframe declares it's truly ready
    if (e.data.type === 'menuReady') {
      reveal();
      return;
    }
  });

  // Ask for size once the iframe DOM exists (helps avoid 0px)
  frame.addEventListener('load', function () {
    try { frame.contentWindow.postMessage({ type: 'requestMenuSize' }, '*'); } catch {}
    // IMPORTANT: no early reveal here (removes the “leaves too fast” issue)
  });

  // Ultimate failsafe (never stick forever)
  setTimeout(reveal, 30000);
})();
</script>
